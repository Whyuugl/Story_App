/*! For license information please see bundle.js.LICENSE.txt */
(()=>{"use strict";var n={56:(n,t,e)=>{n.exports=function(n){var t=e.nc;t&&n.setAttribute("nonce",t)}},72:n=>{var t=[];function e(n){for(var e=-1,r=0;r<t.length;r++)if(t[r].identifier===n){e=r;break}return e}function r(n,r){for(var a={},i=[],s=0;s<n.length;s++){var c=n[s],u=r.base?c[0]+r.base:c[0],l=a[u]||0,d="".concat(u," ").concat(l);a[u]=l+1;var p=e(d),h={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==p)t[p].references++,t[p].updater(h);else{var f=o(h,r);r.byIndex=s,t.splice(s,0,{identifier:d,updater:f,references:1})}i.push(d)}return i}function o(n,t){var e=t.domAPI(t);return e.update(n),function(t){if(t){if(t.css===n.css&&t.media===n.media&&t.sourceMap===n.sourceMap&&t.supports===n.supports&&t.layer===n.layer)return;e.update(n=t)}else e.remove()}}n.exports=function(n,o){var a=r(n=n||[],o=o||{});return function(n){n=n||[];for(var i=0;i<a.length;i++){var s=e(a[i]);t[s].references--}for(var c=r(n,o),u=0;u<a.length;u++){var l=e(a[u]);0===t[l].references&&(t[l].updater(),t.splice(l,1))}a=c}}},113:n=>{n.exports=function(n,t){if(t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}},314:n=>{n.exports=function(n){var t=[];return t.toString=function(){return this.map((function(t){var e="",r=void 0!==t[5];return t[4]&&(e+="@supports (".concat(t[4],") {")),t[2]&&(e+="@media ".concat(t[2]," {")),r&&(e+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),e+=n(t),r&&(e+="}"),t[2]&&(e+="}"),t[4]&&(e+="}"),e})).join("")},t.i=function(n,e,r,o,a){"string"==typeof n&&(n=[[null,n,void 0]]);var i={};if(r)for(var s=0;s<this.length;s++){var c=this[s][0];null!=c&&(i[c]=!0)}for(var u=0;u<n.length;u++){var l=[].concat(n[u]);r&&i[l[0]]||(void 0!==a&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=a),e&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=e):l[2]=e),o&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=o):l[4]="".concat(o)),t.push(l))}},t}},365:(n,t,e)=>{e.d(t,{A:()=>s});var r=e(601),o=e.n(r),a=e(314),i=e.n(a)()(o());i.push([n.id,'/* Base styles */\n:root {\n    /* Light Theme Colors */\n    --primary-color: #4F46E5;\n    --primary-color-dark: #4338CA;\n    --secondary-color: #6B7280;\n    --accent-color: #EC4899;\n    --background-color: #F9FAFB;\n    --card-background: #FFFFFF;\n    --text-color: #1F2937;\n    --text-secondary: #4B5563;\n    --text-tertiary: #6B7280;\n    --light-gray: #F3F4F6;\n    --border-color: #E5E7EB;\n    --success-color: #10B981;\n    --error-color: #EF4444;\n    --border-radius: 8px;\n    --box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n    --transition: all 0.2s ease;\n}\n\n[data-theme="dark"] {\n    --primary-color: #818CF8;\n    --primary-color-dark: #6366F1;\n    --secondary-color: #9CA3AF;\n    --accent-color: #F472B6;\n    --background-color: #111827;\n    --card-background: #1F2937;\n    --text-color: #F9FAFB;\n    --text-secondary: #D1D5DB;\n    --text-tertiary: #9CA3AF;\n    --light-gray: #374151;\n    --border-color: #374151;\n    --success-color: #34D399;\n    --error-color: #F87171;\n    --box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);\n}\n\n* {\n    margin: 0;\n    padding: 0;\n    box-sizing: border-box;\n}\n\nbody {\n    font-family: \'Poppins\', sans-serif;\n    background-color: var(--background-color);\n    color: var(--text-color);\n    line-height: 1.6;\n    transition: var(--transition);\n}\n\n/* Layout */\n.container {\n    max-width: 1200px;\n    margin: 0 auto;\n    padding: 0 1rem;\n}\n\n/* Header */\nheader {\n    background-color: var(--card-background);\n    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);\n    position: fixed;\n    width: 100%;\n    top: 0;\n    z-index: 1000;\n    padding: 1rem 2rem;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    border-bottom: 1px solid var(--border-color);\n}\n\nnav {\n    flex: 1;\n    display: flex;\n    justify-content: center;\n}\n\nnav ul {\n    display: flex;\n    list-style: none;\n    gap: 2rem;\n    margin: 0;\n    padding: 0;\n}\n\nnav a {\n    color: var(--text-color);\n    text-decoration: none;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    padding: 0.5rem 1rem;\n    border-radius: 50px;\n    transition: all 0.3s ease;\n    font-weight: 500;\n}\n\nnav a i {\n    font-size: 1.2rem;\n    color: var(--text-color-light);\n    transition: var(--transition);\n}\n\nnav a:hover {\n    background-color: var(--light-gray);\n    color: var(--primary-color);\n}\n\nnav a:hover i {\n    color: var(--primary-color);\n}\n\n.theme-toggle {\n    background-color: var(--light-gray);\n    border: none;\n    color: var(--text-color);\n    width: 40px;\n    height: 40px;\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    cursor: pointer;\n    transition: all 0.3s ease;\n    padding: 0;\n    margin-left: 1rem;\n}\n\n.theme-toggle:hover {\n    background-color: var(--primary-color);\n    color: white;\n    transform: rotate(180deg);\n}\n\n/* Main content */\nmain {\n    padding: 6rem 2rem 2rem;\n    min-height: calc(100vh - 80px);\n}\n\n/* Home page */\n.home-container {\n    max-width: 1200px;\n    margin: 0 auto;\n    padding: 2rem;\n    text-align: center;\n}\n\n.home-header {\n    margin-bottom: 4rem;\n}\n\n.home-header h1 {\n    font-size: 3rem;\n    color: var(--text-color);\n    margin-bottom: 1rem;\n    font-weight: 700;\n}\n\n.subtitle {\n    font-size: 1.2rem;\n    color: var(--text-color-light);\n    max-width: 600px;\n    margin: 0 auto;\n}\n\n.home-content {\n    display: grid;\n    grid-template-columns: repeat(2, 1fr);\n    gap: 2rem;\n    max-width: 1000px;\n    margin: 0 auto;\n}\n\n.feature-card {\n    background: var(--card-background);\n    padding: 2rem;\n    border-radius: var(--border-radius);\n    box-shadow: var(--box-shadow);\n    text-align: left;\n    border: 1px solid var(--border-color);\n    transition: var(--transition);\n}\n\n.feature-card:hover {\n    transform: translateY(-5px);\n    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);\n}\n\n.card-content {\n    margin-top: 1rem;\n}\n\n.card-content h2 {\n    font-size: 1.8rem;\n    color: var(--text-color);\n    margin-bottom: 1rem;\n}\n\n.card-content p {\n    color: var(--text-color-light);\n    margin-bottom: 1.5rem;\n    font-size: 1.1rem;\n}\n\n.card-icon {\n    font-size: 2.5rem;\n    color: var(--primary-color);\n    margin-bottom: 1rem;\n}\n\n.cta-button {\n    display: inline-flex;\n    align-items: center;\n    gap: 0.5rem;\n    background-color: var(--primary-color);\n    color: white;\n    padding: 0.75rem 1.5rem;\n    border-radius: 50px;\n    text-decoration: none;\n    font-weight: 500;\n    transition: var(--transition);\n}\n\n.cta-button:hover {\n    background-color: var(--accent-color);\n    transform: translateY(-2px);\n}\n\n/* Form styles */\n.form-group {\n    margin-bottom: 1.5rem;\n}\n\n.form-group label {\n    display: block;\n    margin-bottom: 0.5rem;\n    color: var(--text-color);\n    font-weight: 500;\n    font-size: 0.95em;\n}\n\n.form-group input,\n.form-group textarea {\n    width: 100%;\n    padding: 0.75rem;\n    border: 1px solid var(--border-color);\n    border-radius: var(--border-radius);\n    background-color: var(--card-background);\n    color: var(--text-color);\n    font-size: 0.95em;\n    transition: var(--transition);\n}\n\n.form-group input:focus,\n.form-group textarea:focus {\n    outline: none;\n    border-color: var(--primary-color);\n    box-shadow: 0 0 0 2px rgba(79, 70, 229, 0.1);\n}\n\n.form-text {\n    display: block;\n    margin-top: 0.5rem;\n    font-size: 0.85em;\n    color: var(--text-tertiary);\n}\n\n.error-message {\n    color: var(--error-color);\n    font-size: 0.9em;\n    margin-top: 0.5rem;\n    padding: 0.75rem;\n    background-color: rgba(239, 68, 68, 0.1);\n    border-radius: var(--border-radius);\n    border: 1px solid var(--error-color);\n}\n\n.success-message {\n    color: var(--success-color);\n    font-size: 0.9em;\n    margin-top: 0.5rem;\n    padding: 0.75rem;\n    background-color: rgba(16, 185, 129, 0.1);\n    border-radius: var(--border-radius);\n    border: 1px solid var(--success-color);\n}\n\n/* Auth container */\n.auth-container {\n    max-width: 400px;\n    margin: 2rem auto;\n    padding: 0 1rem;\n}\n\n.auth-form {\n    background: var(--card-background);\n    padding: 2rem;\n    border-radius: var(--border-radius);\n    box-shadow: var(--box-shadow);\n    border: 1px solid var(--border-color);\n}\n\n.auth-form h2 {\n    text-align: center;\n    margin-bottom: 2rem;\n    color: var(--text-color);\n}\n\n.auth-links {\n    margin-top: 1.5rem;\n    text-align: center;\n}\n\n.auth-links p {\n    color: var(--text-color-light);\n    font-size: 0.9rem;\n}\n\n.auth-link {\n    color: var(--primary-color);\n    text-decoration: none;\n    font-weight: 500;\n    transition: var(--transition);\n}\n\n.auth-link:hover {\n    color: var(--accent-color);\n    text-decoration: underline;\n}\n\n.submit-button {\n    width: 100%;\n    padding: 0.75rem;\n    background-color: var(--primary-color);\n    color: white;\n    border: none;\n    border-radius: var(--border-radius);\n    font-size: 1rem;\n    font-weight: 500;\n    cursor: pointer;\n    transition: var(--transition);\n    margin-top: 1rem;\n}\n\n.submit-button:hover {\n    background-color: var(--accent-color);\n    transform: translateY(-2px);\n}\n\n/* Story cards */\n.stories-container {\n    display: grid;\n    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));\n    gap: 2rem;\n    padding: 1rem;\n    margin-top: 4rem;\n}\n\n.story-card {\n    display: flex;\n    flex-direction: column;\n    background: var(--card-background);\n    border-radius: 8px;\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n    margin-bottom: 20px;\n    padding: 0;\n    transition: transform 0.2s ease;\n    overflow: hidden;\n    border: 1px solid var(--border-color);\n}\n\n.story-image {\n    width: 100%;\n    height: 180px;\n    object-fit: cover;\n    border-top-left-radius: 8px;\n    border-top-right-radius: 8px;\n    background: #eee;\n}\n\n.story-content {\n    padding: 20px;\n    display: flex;\n    flex-direction: column;\n    flex: 1;\n    background: transparent;\n    color: var(--text-color);\n}\n\n.story-title {\n    margin: 0 0 10px 0;\n    font-size: 1.3rem;\n    color: var(--text-color);\n    font-weight: 700;\n    word-break: break-word;\n}\n\n.story-footer {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-top: 16px;\n    gap: 10px;\n}\n\n.story-date {\n    font-size: 0.95rem;\n    color: var(--text-tertiary);\n}\n\n.save-story {\n    background: none;\n    border: none;\n    cursor: pointer;\n    font-size: 1.4rem;\n    color: var(--text-secondary);\n    padding: 5px 10px;\n    transition: color 0.2s ease;\n    margin-left: auto;\n    display: flex;\n    align-items: center;\n}\n\n.save-story.saved {\n    color: var(--accent-color);\n}\n\n.save-story:hover {\n    color: var(--accent-color);\n}\n\n/* Footer */\nfooter {\n    background-color: var(--card-background);\n    color: var(--text-color);\n    text-align: center;\n    padding: 1rem;\n    border-top: 1px solid var(--border-color);\n}\n\nfooter p {\n    color: var(--text-color-light);\n}\n\n/* Skip link container */\n#skip-container {\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    z-index: 9999;\n    display: flex;\n    justify-content: center;\n}\n\n/* Skip link */\n.skip-to-content {\n    position: absolute !important;\n    height: 1px;\n    width: 1px;\n    overflow: hidden;\n    clip: rect(1px, 1px, 1px, 1px);\n    background: var(--primary-color);\n    color: white;\n    padding: 12px 24px;\n    border-radius: var(--border-radius);\n    text-decoration: none;\n    font-weight: 500;\n    text-align: center;\n    z-index: 9999;\n}\n\n.skip-to-content:focus-visible {\n    position: fixed !important;\n    height: auto;\n    width: auto;\n    overflow: visible;\n    clip: auto;\n    top: 16px;\n    left: 50%;\n    transform: translateX(-50%);\n    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);\n    outline: 3px solid var(--accent-color);\n    outline-offset: 2px;\n}\n\n/* Main content */\n#main-content {\n    outline: none;\n    scroll-margin-top: 100px; /* Add space for fixed header */\n}\n\n#main-content:focus-visible {\n    outline: 3px solid var(--accent-color);\n    outline-offset: 2px;\n    background-color: var(--light-gray);\n    transition: background-color 0.3s ease;\n}\n\n/* Remove focus outline for mouse clicks */\n*:focus:not(:focus-visible) {\n    outline: none;\n}\n\n/* App logo */\n.app-logo {\n    font-size: 1.5rem;\n    font-weight: 700;\n    color: var(--primary-color);\n    text-decoration: none;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    padding: 0.5rem 1rem;\n    border-radius: var(--border-radius);\n    transition: var(--transition);\n    margin-right: 1rem;\n    cursor: pointer;\n}\n\n.app-logo:hover,\n.app-logo:focus {\n    background-color: var(--light-gray);\n    outline: none;\n}\n\n.app-logo:focus-visible {\n    outline: 3px solid var(--accent-color);\n}\n\n/* View transitions */\n::view-transition-old(root),\n::view-transition-new(root) {\n    animation: none;\n    mix-blend-mode: normal;\n}\n\n/* Responsive design */\n@media (max-width: 992px) {\n    .home-content {\n        grid-template-columns: 1fr;\n        max-width: 600px;\n    }\n\n    .home-header h1 {\n        font-size: 2.5rem;\n    }\n}\n\n@media (max-width: 768px) {\n    header {\n        padding: 1rem;\n    }\n\n    nav ul {\n        gap: 1rem;\n    }\n\n    nav a {\n        font-size: 0.9rem;\n        padding: 0.4rem 0.8rem;\n    }\n\n    nav a i {\n        font-size: 1rem;\n    }\n\n    .theme-toggle {\n        width: 35px;\n        height: 35px;\n    }\n}\n\n@media (max-width: 576px) {\n    nav a span {\n        display: none;\n    }\n\n    nav a {\n        padding: 0.5rem;\n    }\n\n    nav a i {\n        font-size: 1.2rem;\n        margin: 0;\n    }\n\n    .home-container {\n        padding: 1rem;\n    }\n\n    .home-header h1 {\n        font-size: 2rem;\n    }\n\n    .subtitle {\n        font-size: 1rem;\n    }\n\n    .card-content h2 {\n        font-size: 1.5rem;\n    }\n\n    .card-content p {\n        font-size: 1rem;\n    }\n}\n\n/* Photo options */\n.photo-options {\n    display: flex;\n    gap: 1rem;\n    margin-bottom: 0.5rem;\n}\n\n.photo-option {\n    flex: 1;\n    position: relative;\n}\n\n.photo-option input[type="file"] {\n    position: absolute;\n    width: 1px;\n    height: 1px;\n    padding: 0;\n    margin: -1px;\n    overflow: hidden;\n    clip: rect(0, 0, 0, 0);\n    border: 0;\n}\n\n.option-button {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    gap: 0.5rem;\n    padding: 1rem;\n    background-color: var(--card-background);\n    border: 2px solid var(--border-color);\n    border-radius: var(--border-radius);\n    cursor: pointer;\n    transition: var(--transition);\n    text-align: center;\n    min-height: 100px;\n}\n\n.option-button:hover {\n    border-color: var(--primary-color);\n    background-color: var(--light-gray);\n    transform: translateY(-2px);\n}\n\n.option-button i {\n    font-size: 2rem;\n    color: var(--primary-color);\n}\n\n.option-button span {\n    font-weight: 500;\n    color: var(--text-color);\n}\n\n/* Camera preview */\n#camera-preview {\n    margin-bottom: 1rem;\n    position: relative;\n}\n\n#video {\n    width: 100%;\n    max-height: 400px;\n    object-fit: cover;\n    border-radius: var(--border-radius);\n    box-shadow: var(--box-shadow);\n}\n\n.capture-button {\n    position: absolute;\n    bottom: 1rem;\n    left: 50%;\n    transform: translateX(-50%);\n    background-color: var(--primary-color);\n    color: white;\n    border: none;\n    border-radius: 50px;\n    padding: 0.75rem 1.5rem;\n    font-size: 1rem;\n    font-weight: 500;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);\n    transition: var(--transition);\n}\n\n.capture-button:hover {\n    background-color: var(--accent-color);\n    transform: translateX(-50%) translateY(-2px);\n    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);\n}\n\n.capture-button i {\n    font-size: 1.2rem;\n}\n\n/* Camera controls */\n.camera-controls {\n    position: absolute;\n    bottom: 1rem;\n    left: 0;\n    right: 0;\n    display: flex;\n    justify-content: center;\n    gap: 1rem;\n    padding: 0 1rem;\n}\n\n.close-camera-button {\n    position: absolute;\n    top: 1rem;\n    right: 1rem;\n    background-color: rgba(0, 0, 0, 0.5);\n    color: white;\n    border: none;\n    border-radius: 50%;\n    width: 40px;\n    height: 40px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    cursor: pointer;\n    transition: var(--transition);\n}\n\n.close-camera-button:hover {\n    background-color: rgba(0, 0, 0, 0.7);\n    transform: scale(1.1);\n}\n\n/* Photo preview */\n#photo-preview {\n    margin: 1rem 0;\n    position: relative;\n}\n\n#preview-image {\n    max-height: 400px;\n    object-fit: cover;\n    box-shadow: var(--box-shadow);\n}\n\n.photo-status {\n    position: absolute;\n    top: 1rem;\n    left: 1rem;\n    background-color: var(--success-color);\n    color: white;\n    padding: 0.5rem 1rem;\n    border-radius: 50px;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    font-weight: 500;\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);\n}\n\n.photo-status i {\n    font-size: 1.2rem;\n}\n\n/* Header buttons */\n.header-buttons {\n    display: flex;\n    align-items: center;\n    gap: 1rem;\n}\n\n.auth-button {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    background-color: var(--primary-color);\n    color: white;\n    border: none;\n    border-radius: 50px;\n    padding: 0.5rem 1rem;\n    font-size: 0.9rem;\n    font-weight: 500;\n    cursor: pointer;\n    transition: var(--transition);\n}\n\n.auth-button:hover {\n    background-color: var(--accent-color);\n    transform: translateY(-2px);\n}\n\n.auth-button i {\n    font-size: 1rem;\n}\n\n/* Responsive header */\n@media (max-width: 768px) {\n    .header-buttons {\n        gap: 0.5rem;\n    }\n\n    .auth-button span {\n        display: none;\n    }\n\n    .auth-button {\n        padding: 0.5rem;\n        border-radius: 50%;\n        width: 40px;\n        height: 40px;\n        justify-content: center;\n    }\n\n    .auth-button i {\n        margin: 0;\n    }\n}\n\n.map-container {\n    margin-top: 2rem;\n    padding: 1rem;\n    background: var(--card-background);\n    border-radius: var(--border-radius);\n    box-shadow: var(--box-shadow);\n    width: 100%;\n    height: 500px;\n}\n\n#home-map {\n    width: 100%;\n    height: 100%;\n    border-radius: var(--border-radius);\n    z-index: 1;\n}\n\n.map-container h2 {\n    color: var(--text-color);\n    margin-bottom: 1rem;\n    text-align: center;\n}\n\n.story-popup {\n    max-width: 300px;\n    background: var(--card-background);\n    border-radius: var(--border-radius);\n    overflow: hidden;\n    box-shadow: var(--box-shadow);\n}\n\n.story-popup-image {\n    width: 100%;\n    height: 180px;\n    object-fit: cover;\n    border-radius: var(--border-radius) var(--border-radius) 0 0;\n}\n\n.story-popup-content {\n    padding: 16px;\n}\n\n.story-popup-header {\n    display: flex;\n    align-items: center;\n    gap: 12px;\n    margin-bottom: 12px;\n}\n\n.story-popup-avatar {\n    width: 40px;\n    height: 40px;\n    background-color: var(--primary-color);\n    color: white;\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-weight: 600;\n    font-size: 1.1em;\n}\n\n.story-popup-info {\n    flex: 1;\n}\n\n.story-popup-name {\n    margin: 0;\n    font-size: 1.1em;\n    font-weight: 600;\n    color: var(--text-color);\n}\n\n.story-popup-date {\n    margin: 4px 0 0;\n    font-size: 0.85em;\n    color: var(--text-tertiary);\n}\n\n.story-popup-description {\n    margin: 0 0 16px;\n    font-size: 0.95em;\n    line-height: 1.5;\n    color: var(--text-secondary);\n}\n\n.story-popup-footer {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    margin-top: 12px;\n    padding-top: 12px;\n    border-top: 1px solid var(--border-color);\n}\n\n.story-popup-location {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    color: var(--text-tertiary);\n    font-size: 0.9em;\n}\n\n.story-popup-location i {\n    color: var(--primary-color);\n}\n\n.story-popup-view {\n    padding: 6px 12px;\n    background-color: var(--primary-color);\n    color: white;\n    text-decoration: none;\n    border-radius: 4px;\n    font-size: 0.9em;\n    font-weight: 500;\n    transition: var(--transition);\n}\n\n.story-popup-view:hover {\n    background-color: var(--primary-color-dark);\n    transform: translateY(-1px);\n}\n\n/* Override Leaflet\'s default popup styles */\n.leaflet-popup-content-wrapper {\n    padding: 0;\n    border-radius: 8px;\n    overflow: hidden;\n}\n\n.leaflet-popup-content {\n    margin: 0;\n    width: 300px !important;\n}\n\n.leaflet-popup-close-button {\n    color: white !important;\n    font-size: 20px !important;\n    padding: 8px !important;\n    text-shadow: 0 1px 2px rgba(0,0,0,0.2);\n}\n\n/* Page Transitions */\n@keyframes fadeSlideIn {\n    0% {\n        opacity: 0;\n        transform: translateY(20px);\n    }\n    100% {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n@keyframes fadeSlideOut {\n    0% {\n        opacity: 1;\n        transform: translateY(0);\n    }\n    100% {\n        opacity: 0;\n        transform: translateY(-20px);\n    }\n}\n\n.page-transition {\n    animation: fadeSlideIn 0.5s ease forwards;\n}\n\n.auth-container,\n.stories-container,\n.add-story-container,\n.home-container {\n    animation: fadeSlideIn 0.5s ease forwards;\n}\n\n.story-card {\n    opacity: 0;\n    animation: fadeSlideIn 0.5s ease forwards;\n}\n\n/* Stagger animation for story cards */\n.stories-container .story-card:nth-child(1) { animation-delay: 0.1s; }\n.stories-container .story-card:nth-child(2) { animation-delay: 0.2s; }\n.stories-container .story-card:nth-child(3) { animation-delay: 0.3s; }\n.stories-container .story-card:nth-child(4) { animation-delay: 0.4s; }\n.stories-container .story-card:nth-child(5) { animation-delay: 0.5s; }\n.stories-container .story-card:nth-child(n+6) { animation-delay: 0.6s; }\n\n/* Home page animations */\n.home-header {\n    opacity: 0;\n    animation: fadeSlideIn 0.5s ease forwards;\n}\n\n.home-content .feature-card {\n    opacity: 0;\n    animation: fadeSlideIn 0.5s ease forwards;\n}\n\n.home-content .feature-card:nth-child(1) {\n    animation-delay: 0.2s;\n}\n\n.home-content .feature-card:nth-child(2) {\n    animation-delay: 0.4s;\n}\n\n.map-container {\n    opacity: 0;\n    animation: fadeSlideIn 0.8s ease forwards;\n    animation-delay: 0.6s;\n}\n\n/* Form animations */\n.form-group {\n    opacity: 0;\n    animation: fadeSlideIn 0.5s ease forwards;\n}\n\n.auth-form .form-group:nth-child(1) { animation-delay: 0.1s; }\n.auth-form .form-group:nth-child(2) { animation-delay: 0.2s; }\n.auth-form .form-group:nth-child(3) { animation-delay: 0.3s; }\n.auth-form .submit-button { \n    opacity: 0;\n    animation: fadeSlideIn 0.5s ease forwards;\n    animation-delay: 0.4s; \n}\n\n/* Photo options animation */\n.photo-options {\n    opacity: 0;\n    animation: fadeSlideIn 0.5s ease forwards;\n    animation-delay: 0.2s;\n}\n\n/* Success and error message animations */\n.success-message,\n.error-message {\n    animation: fadeSlideIn 0.3s ease forwards;\n}\n\n.app-logo {\n    font-size: 1.5rem;\n    font-weight: 700;\n    color: var(--primary-color);\n    text-decoration: none;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    padding: 0.5rem 1rem;\n    border-radius: var(--border-radius);\n    transition: var(--transition);\n    margin-right: 1rem;\n}\n\n.app-logo i {\n    font-size: 1.8rem;\n}\n\n.app-logo:hover,\n.app-logo:focus {\n    background-color: var(--light-gray);\n    outline: none;\n}\n\n.app-logo:focus-visible {\n    outline: 3px solid var(--accent-color);\n}\n\n/* Skip link container */\n#skip-container {\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    z-index: 9999;\n    display: flex;\n    justify-content: center;\n}\n\n/* Show skip link only after app logo is focused and then tabbed to */\n.app-logo:focus ~ #skip-container .skip-to-content {\n    opacity: 1;\n    pointer-events: auto;\n}\n\n.skip-to-content:focus {\n    top: 16px;\n    opacity: 1;\n    pointer-events: auto;\n    outline: 3px solid var(--accent-color);\n}\n\n.notification-button {\n    background: none;\n    border: none;\n    cursor: pointer;\n    padding: 8px;\n    border-radius: 50%;\n    transition: all 0.3s ease;\n    position: relative;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: 40px;\n    height: 40px;\n    margin-left: 8px;\n}\n\n.notification-button:hover {\n    background-color: rgba(0, 0, 0, 0.1);\n    transform: scale(1.1);\n}\n\n.notification-button i {\n    font-size: 1.2rem;\n    color: #666;\n    transition: all 0.3s ease;\n}\n\n.notification-button.active {\n    background-color: rgba(33, 150, 243, 0.1);\n}\n\n.notification-button.active i {\n    color: #2196f3;\n    animation: ring 1s ease-in-out;\n}\n\n.notification-button:focus {\n    outline: none;\n    box-shadow: 0 0 0 2px rgba(33, 150, 243, 0.3);\n}\n\n@keyframes ring {\n    0% { transform: rotate(0deg); }\n    25% { transform: rotate(15deg); }\n    50% { transform: rotate(-15deg); }\n    75% { transform: rotate(15deg); }\n    100% { transform: rotate(0deg); }\n}\n\n.not-found {\n    text-align: center;\n    padding: 2rem;\n    margin: 2rem auto;\n    max-width: 600px;\n}\n\n.not-found h2 {\n    font-size: 2.5rem;\n    color: #e74c3c;\n    margin-bottom: 1rem;\n}\n\n.not-found p {\n    font-size: 1.2rem;\n    color: #666;\n    margin-bottom: 2rem;\n}\n\n.back-home {\n    display: inline-block;\n    padding: 0.8rem 1.5rem;\n    background-color: #3498db;\n    color: white;\n    text-decoration: none;\n    border-radius: 4px;\n    transition: background-color 0.3s ease;\n}\n\n.back-home:hover {\n    background-color: #2980b9;\n} ',""]);const s=i},540:n=>{n.exports=function(n){var t=document.createElement("style");return n.setAttributes(t,n.attributes),n.insert(t,n.options),t}},601:n=>{n.exports=function(n){return n[1]}},659:n=>{var t={};n.exports=function(n,e){var r=function(n){if(void 0===t[n]){var e=document.querySelector(n);if(window.HTMLIFrameElement&&e instanceof window.HTMLIFrameElement)try{e=e.contentDocument.head}catch(n){e=null}t[n]=e}return t[n]}(n);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(e)}},825:n=>{n.exports=function(n){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=n.insertStyleElement(n);return{update:function(e){!function(n,t,e){var r="";e.supports&&(r+="@supports (".concat(e.supports,") {")),e.media&&(r+="@media ".concat(e.media," {"));var o=void 0!==e.layer;o&&(r+="@layer".concat(e.layer.length>0?" ".concat(e.layer):""," {")),r+=e.css,o&&(r+="}"),e.media&&(r+="}"),e.supports&&(r+="}");var a=e.sourceMap;a&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),t.styleTagTransform(r,n,t.options)}(t,n,e)},remove:function(){!function(n){if(null===n.parentNode)return!1;n.parentNode.removeChild(n)}(t)}}}}},t={};function e(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={id:r,exports:{}};return n[r](a,a.exports,e),a.exports}e.n=n=>{var t=n&&n.__esModule?()=>n.default:()=>n;return e.d(t,{a:t}),t},e.d=(n,t)=>{for(var r in t)e.o(t,r)&&!e.o(n,r)&&Object.defineProperty(n,r,{enumerable:!0,get:t[r]})},e.o=(n,t)=>Object.prototype.hasOwnProperty.call(n,t),e.nc=void 0;var r=e(72),o=e.n(r),a=e(825),i=e.n(a),s=e(659),c=e.n(s),u=e(56),l=e.n(u),d=e(540),p=e.n(d),h=e(113),f=e.n(h),m=e(365),v={};v.styleTagTransform=f(),v.setAttributes=l(),v.insert=c().bind(null,"head"),v.domAPI=i(),v.insertStyleElement=p(),o()(m.A,v),m.A&&m.A.locals&&m.A.locals;var y="https://story-api.dicoding.dev/v1",g={REGISTER:"".concat(y,"/register"),LOGIN:"".concat(y,"/login"),STORIES:"".concat(y,"/stories"),STORIES_GUEST:"".concat(y,"/stories/guest"),NOTIFICATIONS:"".concat(y,"/notifications/subscribe")},b={DEFAULT_ZOOM:5,DEFAULT_CENTER:[-2.5489,118.0149],TILE_LAYERS:[{name:"OpenStreetMap",url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:"© OpenStreetMap contributors"},{name:"Satellite",url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",attribution:"© Esri"},{name:"Topographic",url:"https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png",attribution:"© OpenTopoMap"}]},w="#/",x="#/stories",k="#/login",E="#/register";function S(n){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},S(n)}function j(){j=function(){return t};var n,t={},e=Object.prototype,r=e.hasOwnProperty,o=Object.defineProperty||function(n,t,e){n[t]=e.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function u(n,t,e){return Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}),n[t]}try{u({},"")}catch(n){u=function(n,t,e){return n[t]=e}}function l(n,t,e,r){var a=t&&t.prototype instanceof y?t:y,i=Object.create(a.prototype),s=new I(r||[]);return o(i,"_invoke",{value:O(n,e,s)}),i}function d(n,t,e){try{return{type:"normal",arg:n.call(t,e)}}catch(n){return{type:"throw",arg:n}}}t.wrap=l;var p="suspendedStart",h="suspendedYield",f="executing",m="completed",v={};function y(){}function g(){}function b(){}var w={};u(w,i,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(_([])));k&&k!==e&&r.call(k,i)&&(w=k);var E=b.prototype=y.prototype=Object.create(w);function L(n){["next","throw","return"].forEach((function(t){u(n,t,(function(n){return this._invoke(t,n)}))}))}function T(n,t){function e(o,a,i,s){var c=d(n[o],n,a);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==S(l)&&r.call(l,"__await")?t.resolve(l.__await).then((function(n){e("next",n,i,s)}),(function(n){e("throw",n,i,s)})):t.resolve(l).then((function(n){u.value=n,i(u)}),(function(n){return e("throw",n,i,s)}))}s(c.arg)}var a;o(this,"_invoke",{value:function(n,r){function o(){return new t((function(t,o){e(n,r,t,o)}))}return a=a?a.then(o,o):o()}})}function O(t,e,r){var o=p;return function(a,i){if(o===f)throw Error("Generator is already running");if(o===m){if("throw"===a)throw i;return{value:n,done:!0}}for(r.method=a,r.arg=i;;){var s=r.delegate;if(s){var c=P(s,r);if(c){if(c===v)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=f;var u=d(t,e,r);if("normal"===u.type){if(o=r.done?m:h,u.arg===v)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=m,r.method="throw",r.arg=u.arg)}}}function P(t,e){var r=e.method,o=t.iterator[r];if(o===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=n,P(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var a=d(o,t.iterator,e.arg);if("throw"===a.type)return e.method="throw",e.arg=a.arg,e.delegate=null,v;var i=a.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,v):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,v)}function A(n){var t={tryLoc:n[0]};1 in n&&(t.catchLoc=n[1]),2 in n&&(t.finallyLoc=n[2],t.afterLoc=n[3]),this.tryEntries.push(t)}function F(n){var t=n.completion||{};t.type="normal",delete t.arg,n.completion=t}function I(n){this.tryEntries=[{tryLoc:"root"}],n.forEach(A,this),this.reset(!0)}function _(t){if(t||""===t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function e(){for(;++o<t.length;)if(r.call(t,o))return e.value=t[o],e.done=!1,e;return e.value=n,e.done=!0,e};return a.next=a}}throw new TypeError(S(t)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(n){var t="function"==typeof n&&n.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,b):(n.__proto__=b,u(n,c,"GeneratorFunction")),n.prototype=Object.create(E),n},t.awrap=function(n){return{__await:n}},L(T.prototype),u(T.prototype,s,(function(){return this})),t.AsyncIterator=T,t.async=function(n,e,r,o,a){void 0===a&&(a=Promise);var i=new T(l(n,e,r,o),a);return t.isGeneratorFunction(e)?i:i.next().then((function(n){return n.done?n.value:i.next()}))},L(E),u(E,c,"Generator"),u(E,i,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),t.keys=function(n){var t=Object(n),e=[];for(var r in t)e.push(r);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=_,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(F),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var n=this.tryEntries[0].completion;if("throw"===n.type)throw n.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function o(r,o){return s.type="throw",s.arg=t,e.next=r,o&&(e.method="next",e.arg=n),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],s=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(n,t){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===n||"continue"===n)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=n,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(i)},complete:function(n,t){if("throw"===n.type)throw n.arg;return"break"===n.type||"continue"===n.type?this.next=n.arg:"return"===n.type?(this.rval=this.arg=n.arg,this.method="return",this.next="end"):"normal"===n.type&&t&&(this.next=t),v},finish:function(n){for(var t=this.tryEntries.length-1;t>=0;--t){var e=this.tryEntries[t];if(e.finallyLoc===n)return this.complete(e.completion,e.afterLoc),F(e),v}},catch:function(n){for(var t=this.tryEntries.length-1;t>=0;--t){var e=this.tryEntries[t];if(e.tryLoc===n){var r=e.completion;if("throw"===r.type){var o=r.arg;F(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:_(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=n),v}},t}function T(n,t,e,r,o,a,i){try{var s=n[a](i),c=s.value}catch(n){return void e(n)}s.done?t(c):Promise.resolve(c).then(r,o)}function O(n){return function(){var t=this,e=arguments;return new Promise((function(r,o){var a=n.apply(t,e);function i(n){T(a,r,o,i,s,"next",n)}function s(n){T(a,r,o,i,s,"throw",n)}i(void 0)}))}}function P(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,A(r.key),r)}}function A(n){var t=function(n){if("object"!=S(n)||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var e=t.call(n,"string");if("object"!=S(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(n);return"symbol"==S(t)?t:t+""}var F=function(){return n=function n(){!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.stories=[],this.token=localStorage.getItem("token"),this.onAuthStateChange=null},t=[{key:"logout",value:function(){this.token=null,localStorage.removeItem("token"),this.onAuthStateChange&&this.onAuthStateChange()}},{key:"login",value:(a=O(j().mark((function n(t,e){var r,o;return j().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,fetch(g.LOGIN,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,password:e})});case 3:return r=n.sent,n.next=6,r.json();case 6:if((o=n.sent).error){n.next=12;break}return this.token=o.loginResult.token,localStorage.setItem("token",this.token),this.onAuthStateChange&&this.onAuthStateChange(),n.abrupt("return",!0);case 12:throw new Error(o.message);case 15:throw n.prev=15,n.t0=n.catch(0),console.error("Error logging in:",n.t0),new Error("Login failed. Please check your credentials.");case 19:case"end":return n.stop()}}),n,this,[[0,15]])}))),function(n,t){return a.apply(this,arguments)})},{key:"register",value:(o=O(j().mark((function n(t,e,r){var o,a;return j().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)){n.next=4;break}throw new Error("Please enter a valid email address");case 4:if(!(r.length<8)){n.next=6;break}throw new Error("Password must be at least 8 characters long");case 6:return n.next=8,fetch(g.REGISTER,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:t,email:e,password:r})});case 8:return o=n.sent,n.next=11,o.json();case 11:if((a=n.sent).error){n.next=14;break}return n.abrupt("return",!0);case 14:throw new Error(a.message);case 17:throw n.prev=17,n.t0=n.catch(0),console.error("Error registering:",n.t0),n.t0;case 21:case"end":return n.stop()}}),n,null,[[0,17]])}))),function(n,t,e){return o.apply(this,arguments)})},{key:"isAuthenticated",value:function(){return Boolean(this.token&&this.token.length>0)}},{key:"fetchStories",value:(r=O(j().mark((function n(){var t,e;return j().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this.isAuthenticated()){n.next=2;break}throw new Error("Not authenticated");case 2:return n.prev=2,n.next=5,fetch(g.STORIES,{headers:{Authorization:"Bearer ".concat(this.token)}});case 5:return t=n.sent,n.next=8,t.json();case 8:if((e=n.sent).error){n.next=12;break}return this.stories=e.listStory,n.abrupt("return",this.stories);case 12:throw new Error(e.message);case 15:throw n.prev=15,n.t0=n.catch(2),console.error("Error fetching stories:",n.t0),n.t0;case 19:case"end":return n.stop()}}),n,this,[[2,15]])}))),function(){return r.apply(this,arguments)})},{key:"addStory",value:(e=O(j().mark((function n(t){var e,r;return j().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this.isAuthenticated()){n.next=2;break}throw new Error("Not authenticated");case 2:return n.prev=2,n.next=5,fetch(g.STORIES,{method:"POST",headers:{Authorization:"Bearer ".concat(this.token)},body:t});case 5:return e=n.sent,n.next=8,e.json();case 8:if((r=n.sent).error){n.next=11;break}return n.abrupt("return",!0);case 11:throw new Error(r.message);case 14:throw n.prev=14,n.t0=n.catch(2),console.error("Error adding story:",n.t0),n.t0;case 18:case"end":return n.stop()}}),n,this,[[2,14]])}))),function(n){return e.apply(this,arguments)})}],t&&P(n.prototype,t),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,t,e,r,o,a}();function I(n){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},I(n)}function _(){_=function(){return t};var n,t={},e=Object.prototype,r=e.hasOwnProperty,o=Object.defineProperty||function(n,t,e){n[t]=e.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function u(n,t,e){return Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}),n[t]}try{u({},"")}catch(n){u=function(n,t,e){return n[t]=e}}function l(n,t,e,r){var a=t&&t.prototype instanceof y?t:y,i=Object.create(a.prototype),s=new A(r||[]);return o(i,"_invoke",{value:j(n,e,s)}),i}function d(n,t,e){try{return{type:"normal",arg:n.call(t,e)}}catch(n){return{type:"throw",arg:n}}}t.wrap=l;var p="suspendedStart",h="suspendedYield",f="executing",m="completed",v={};function y(){}function g(){}function b(){}var w={};u(w,i,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(F([])));k&&k!==e&&r.call(k,i)&&(w=k);var E=b.prototype=y.prototype=Object.create(w);function L(n){["next","throw","return"].forEach((function(t){u(n,t,(function(n){return this._invoke(t,n)}))}))}function S(n,t){function e(o,a,i,s){var c=d(n[o],n,a);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==I(l)&&r.call(l,"__await")?t.resolve(l.__await).then((function(n){e("next",n,i,s)}),(function(n){e("throw",n,i,s)})):t.resolve(l).then((function(n){u.value=n,i(u)}),(function(n){return e("throw",n,i,s)}))}s(c.arg)}var a;o(this,"_invoke",{value:function(n,r){function o(){return new t((function(t,o){e(n,r,t,o)}))}return a=a?a.then(o,o):o()}})}function j(t,e,r){var o=p;return function(a,i){if(o===f)throw Error("Generator is already running");if(o===m){if("throw"===a)throw i;return{value:n,done:!0}}for(r.method=a,r.arg=i;;){var s=r.delegate;if(s){var c=T(s,r);if(c){if(c===v)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=f;var u=d(t,e,r);if("normal"===u.type){if(o=r.done?m:h,u.arg===v)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=m,r.method="throw",r.arg=u.arg)}}}function T(t,e){var r=e.method,o=t.iterator[r];if(o===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=n,T(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var a=d(o,t.iterator,e.arg);if("throw"===a.type)return e.method="throw",e.arg=a.arg,e.delegate=null,v;var i=a.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,v):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,v)}function O(n){var t={tryLoc:n[0]};1 in n&&(t.catchLoc=n[1]),2 in n&&(t.finallyLoc=n[2],t.afterLoc=n[3]),this.tryEntries.push(t)}function P(n){var t=n.completion||{};t.type="normal",delete t.arg,n.completion=t}function A(n){this.tryEntries=[{tryLoc:"root"}],n.forEach(O,this),this.reset(!0)}function F(t){if(t||""===t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function e(){for(;++o<t.length;)if(r.call(t,o))return e.value=t[o],e.done=!1,e;return e.value=n,e.done=!0,e};return a.next=a}}throw new TypeError(I(t)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(n){var t="function"==typeof n&&n.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,b):(n.__proto__=b,u(n,c,"GeneratorFunction")),n.prototype=Object.create(E),n},t.awrap=function(n){return{__await:n}},L(S.prototype),u(S.prototype,s,(function(){return this})),t.AsyncIterator=S,t.async=function(n,e,r,o,a){void 0===a&&(a=Promise);var i=new S(l(n,e,r,o),a);return t.isGeneratorFunction(e)?i:i.next().then((function(n){return n.done?n.value:i.next()}))},L(E),u(E,c,"Generator"),u(E,i,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),t.keys=function(n){var t=Object(n),e=[];for(var r in t)e.push(r);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=F,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(P),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var n=this.tryEntries[0].completion;if("throw"===n.type)throw n.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function o(r,o){return s.type="throw",s.arg=t,e.next=r,o&&(e.method="next",e.arg=n),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],s=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(n,t){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===n||"continue"===n)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=n,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(i)},complete:function(n,t){if("throw"===n.type)throw n.arg;return"break"===n.type||"continue"===n.type?this.next=n.arg:"return"===n.type?(this.rval=this.arg=n.arg,this.method="return",this.next="end"):"normal"===n.type&&t&&(this.next=t),v},finish:function(n){for(var t=this.tryEntries.length-1;t>=0;--t){var e=this.tryEntries[t];if(e.finallyLoc===n)return this.complete(e.completion,e.afterLoc),P(e),v}},catch:function(n){for(var t=this.tryEntries.length-1;t>=0;--t){var e=this.tryEntries[t];if(e.tryLoc===n){var r=e.completion;if("throw"===r.type){var o=r.arg;P(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:F(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=n),v}},t}function N(n,t,e,r,o,a,i){try{var s=n[a](i),c=s.value}catch(n){return void e(n)}s.done?t(c):Promise.resolve(c).then(r,o)}function C(n){return function(){var t=this,e=arguments;return new Promise((function(r,o){var a=n.apply(t,e);function i(n){N(a,r,o,i,s,"next",n)}function s(n){N(a,r,o,i,s,"throw",n)}i(void 0)}))}}function z(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,B(r.key),r)}}function B(n){var t=function(n){if("object"!=I(n)||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var e=t.call(n,"string");if("object"!=I(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(n);return"symbol"==I(t)?t:t+""}const R=new(function(){return n=function n(){!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.dbName="StoryAppDB",this.dbVersion=2,this.storeName="stories"},t=[{key:"openDB",value:(a=C(_().mark((function n(){var t=this;return _().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n,e){var r=indexedDB.open(t.dbName,t.dbVersion);r.onerror=function(){return e(r.error)},r.onsuccess=function(){return n(r.result)},r.onupgradeneeded=function(n){var e=n.target.result;e.objectStoreNames.contains(t.storeName)||e.createObjectStore(t.storeName,{keyPath:"id"})}})));case 1:case"end":return n.stop()}}),n)}))),function(){return a.apply(this,arguments)})},{key:"addStory",value:(o=C(_().mark((function n(t){var e,r=this;return _().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.openDB();case 2:return e=n.sent,n.abrupt("return",new Promise((function(n,o){var a=e.transaction(r.storeName,"readwrite").objectStore(r.storeName).add(t);a.onsuccess=function(){return n(a.result)},a.onerror=function(){return o(a.error)}})));case 4:case"end":return n.stop()}}),n,this)}))),function(n){return o.apply(this,arguments)})},{key:"getAllStories",value:(r=C(_().mark((function n(){var t,e=this;return _().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.openDB();case 2:return t=n.sent,n.abrupt("return",new Promise((function(n,r){var o=t.transaction(e.storeName,"readonly").objectStore(e.storeName).getAll();o.onsuccess=function(){return n(o.result)},o.onerror=function(){return r(o.error)}})));case 4:case"end":return n.stop()}}),n,this)}))),function(){return r.apply(this,arguments)})},{key:"deleteStory",value:(e=C(_().mark((function n(t){var e,r=this;return _().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.openDB();case 2:return e=n.sent,n.abrupt("return",new Promise((function(n,o){var a=e.transaction(r.storeName,"readwrite").objectStore(r.storeName).delete(t);a.onsuccess=function(){return n()},a.onerror=function(){return o(a.error)}})));case 4:case"end":return n.stop()}}),n,this)}))),function(n){return e.apply(this,arguments)})}],t&&z(n.prototype,t),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,t,e,r,o,a}());function G(n){return G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},G(n)}function q(){q=function(){return t};var n,t={},e=Object.prototype,r=e.hasOwnProperty,o=Object.defineProperty||function(n,t,e){n[t]=e.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function u(n,t,e){return Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}),n[t]}try{u({},"")}catch(n){u=function(n,t,e){return n[t]=e}}function l(n,t,e,r){var a=t&&t.prototype instanceof y?t:y,i=Object.create(a.prototype),s=new A(r||[]);return o(i,"_invoke",{value:j(n,e,s)}),i}function d(n,t,e){try{return{type:"normal",arg:n.call(t,e)}}catch(n){return{type:"throw",arg:n}}}t.wrap=l;var p="suspendedStart",h="suspendedYield",f="executing",m="completed",v={};function y(){}function g(){}function b(){}var w={};u(w,i,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(F([])));k&&k!==e&&r.call(k,i)&&(w=k);var E=b.prototype=y.prototype=Object.create(w);function L(n){["next","throw","return"].forEach((function(t){u(n,t,(function(n){return this._invoke(t,n)}))}))}function S(n,t){function e(o,a,i,s){var c=d(n[o],n,a);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==G(l)&&r.call(l,"__await")?t.resolve(l.__await).then((function(n){e("next",n,i,s)}),(function(n){e("throw",n,i,s)})):t.resolve(l).then((function(n){u.value=n,i(u)}),(function(n){return e("throw",n,i,s)}))}s(c.arg)}var a;o(this,"_invoke",{value:function(n,r){function o(){return new t((function(t,o){e(n,r,t,o)}))}return a=a?a.then(o,o):o()}})}function j(t,e,r){var o=p;return function(a,i){if(o===f)throw Error("Generator is already running");if(o===m){if("throw"===a)throw i;return{value:n,done:!0}}for(r.method=a,r.arg=i;;){var s=r.delegate;if(s){var c=T(s,r);if(c){if(c===v)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=f;var u=d(t,e,r);if("normal"===u.type){if(o=r.done?m:h,u.arg===v)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=m,r.method="throw",r.arg=u.arg)}}}function T(t,e){var r=e.method,o=t.iterator[r];if(o===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=n,T(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var a=d(o,t.iterator,e.arg);if("throw"===a.type)return e.method="throw",e.arg=a.arg,e.delegate=null,v;var i=a.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,v):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,v)}function O(n){var t={tryLoc:n[0]};1 in n&&(t.catchLoc=n[1]),2 in n&&(t.finallyLoc=n[2],t.afterLoc=n[3]),this.tryEntries.push(t)}function P(n){var t=n.completion||{};t.type="normal",delete t.arg,n.completion=t}function A(n){this.tryEntries=[{tryLoc:"root"}],n.forEach(O,this),this.reset(!0)}function F(t){if(t||""===t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function e(){for(;++o<t.length;)if(r.call(t,o))return e.value=t[o],e.done=!1,e;return e.value=n,e.done=!0,e};return a.next=a}}throw new TypeError(G(t)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(n){var t="function"==typeof n&&n.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,b):(n.__proto__=b,u(n,c,"GeneratorFunction")),n.prototype=Object.create(E),n},t.awrap=function(n){return{__await:n}},L(S.prototype),u(S.prototype,s,(function(){return this})),t.AsyncIterator=S,t.async=function(n,e,r,o,a){void 0===a&&(a=Promise);var i=new S(l(n,e,r,o),a);return t.isGeneratorFunction(e)?i:i.next().then((function(n){return n.done?n.value:i.next()}))},L(E),u(E,c,"Generator"),u(E,i,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),t.keys=function(n){var t=Object(n),e=[];for(var r in t)e.push(r);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=F,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(P),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var n=this.tryEntries[0].completion;if("throw"===n.type)throw n.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function o(r,o){return s.type="throw",s.arg=t,e.next=r,o&&(e.method="next",e.arg=n),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],s=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(n,t){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===n||"continue"===n)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=n,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(i)},complete:function(n,t){if("throw"===n.type)throw n.arg;return"break"===n.type||"continue"===n.type?this.next=n.arg:"return"===n.type?(this.rval=this.arg=n.arg,this.method="return",this.next="end"):"normal"===n.type&&t&&(this.next=t),v},finish:function(n){for(var t=this.tryEntries.length-1;t>=0;--t){var e=this.tryEntries[t];if(e.finallyLoc===n)return this.complete(e.completion,e.afterLoc),P(e),v}},catch:function(n){for(var t=this.tryEntries.length-1;t>=0;--t){var e=this.tryEntries[t];if(e.tryLoc===n){var r=e.completion;if("throw"===r.type){var o=r.arg;P(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:F(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=n),v}},t}function D(n,t,e,r,o,a,i){try{var s=n[a](i),c=s.value}catch(n){return void e(n)}s.done?t(c):Promise.resolve(c).then(r,o)}function M(n){return function(){var t=this,e=arguments;return new Promise((function(r,o){var a=n.apply(t,e);function i(n){D(a,r,o,i,s,"next",n)}function s(n){D(a,r,o,i,s,"throw",n)}i(void 0)}))}}function Y(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,H(r.key),r)}}function H(n){var t=function(n){if("object"!=G(n)||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var e=t.call(n,"string");if("object"!=G(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(n);return"symbol"==G(t)?t:t+""}var U=function(){return n=function n(){var t=this;!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.app=document.getElementById("app"),this.skipContainer=document.getElementById("skip-container"),this.setupSkipLink(),this.setupLogoListener(),setTimeout((function(){t.setupLogoListener()}),100)},t=[{key:"setupTabListener",value:function(){var n=this;document.addEventListener("keydown",(function(t){if("Tab"===t.key){var e=n.skipContainer.querySelector(".skip-link");e&&(e.style.display="block",e.style.opacity="1",e.style.top="16px",e.focus()),document.removeEventListener("keydown",n.setupTabListener)}}))}},{key:"setupSkipLink",value:function(){var n=document.querySelector(".skip-to-content");n||((n=document.createElement("a")).href="#main-content",n.className="skip-to-content",n.textContent="Skip to main content",n.setAttribute("tabindex","0"),n.addEventListener("click",(function(n){n.preventDefault();var t=document.getElementById("main-content");t&&t.focus()})),document.body.insertBefore(n,document.body.firstChild))}},{key:"setupLogoListener",value:function(){var n=this,t=document.querySelector(".app-logo");console.log("Setting up logo listener:",t),t&&t.addEventListener("focus",(function(){n.setupTabListener()}))}},{key:"renderLoginForm",value:function(){document.getElementById("app").innerHTML='\n            <main id="main-content" class="auth-container page-transition" tabindex="-1">\n                <form id="login-form" class="auth-form">\n                    <h2>Login</h2>\n                    <div class="form-group">\n                        <label for="email">Email</label>\n                        <input type="email" id="email" name="email" required aria-required="true">\n                    </div>\n                    <div class="form-group">\n                        <label for="password">Password</label>\n                        <input type="password" id="password" name="password" required aria-required="true">\n                    </div>\n                    <button type="submit" class="submit-button">Login</button>\n                    <div class="auth-links">\n                        <p>Don\'t have an account? <a href="#/register" class="auth-link">Register here</a></p>\n                    </div>\n                </form>\n            </main>\n        '}},{key:"renderRegisterForm",value:function(){document.getElementById("app").innerHTML='\n            <main id="main-content" class="auth-container page-transition" tabindex="-1">\n                <form id="register-form" class="auth-form">\n                    <h2>Register</h2>\n                    <div class="form-group">\n                        <label for="name">Name</label>\n                        <input type="text" id="name" name="name" required aria-required="true">\n                    </div>\n                    <div class="form-group">\n                        <label for="email">Email</label>\n                        <input type="email" id="email" name="email" required \n                               pattern="[^\\s@]+@[^\\s@]+\\.[^\\s@]+"\n                               title="Please enter a valid email address"\n                               aria-required="true">\n                        <small class="form-text">Enter a valid email address</small>\n                    </div>\n                    <div class="form-group">\n                        <label for="password">Password</label>\n                        <input type="password" id="password" name="password" required \n                               minlength="8" pattern=".{8,}" \n                               title="Password must be at least 8 characters long"\n                               aria-required="true">\n                        <small class="form-text">Password must be at least 8 characters long</small>\n                    </div>\n                    <button type="submit" class="submit-button">Register</button>\n                    <div class="auth-links">\n                        <p>Already have an account? <a href="#/login" class="auth-link">Login here</a></p>\n                    </div>\n                </form>\n            </main>\n        '}},{key:"renderStories",value:(e=M(q().mark((function n(t){var e,r,o,a=this;return q().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,R.getAllStories();case 2:e=n.sent,r=new Set(e.map((function(n){return n.id}))),o='\n            <main id="main-content" class="stories-container page-transition" tabindex="-1">\n                '.concat(t.map((function(n){return a.createStoryCard(n,r.has(n.id))})).join(""),"\n            </main>\n        "),this.app.innerHTML=o,document.querySelectorAll(".save-story").forEach((function(n){n.addEventListener("click",function(){var e=M(q().mark((function e(r){var o,i,s,c;return q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=r.target.closest(".story-card"),i=o.dataset.id,s=n.classList.contains("saved"),e.prev=3,!s){e.next=11;break}return e.next=7,R.deleteStory(i);case 7:n.classList.remove("saved"),n.querySelector("i").className="far fa-bookmark",e.next=20;break;case 11:if(c=t.find((function(n){return String(n.id)===String(i)})),console.log("Story to save:",c),c&&c.id){e.next=16;break}return alert("Story data is invalid or missing id!"),e.abrupt("return");case 16:return e.next=18,R.addStory(c);case 18:n.classList.add("saved"),n.querySelector("i").className="fas fa-bookmark";case 20:e.next=26;break;case 22:e.prev=22,e.t0=e.catch(3),console.error("Error saving/deleting story:",e.t0),a.showError("Failed to save/delete story");case 26:case"end":return e.stop()}}),e,null,[[3,22]])})));return function(n){return e.apply(this,arguments)}}())}));case 7:case"end":return n.stop()}}),n,this)}))),function(n){return e.apply(this,arguments)})},{key:"createStoryCard",value:function(n){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return'\n            <article class="story-card" data-id="'.concat(n.id,'" aria-labelledby="story-title-').concat(n.id,'">\n                <img src="').concat(n.photoUrl,'" alt="').concat(n.description,'" class="story-image">\n                <div class="story-content">\n                    <h2 class="story-title" id="story-title-').concat(n.id,'">').concat(n.name,"</h2>\n                    <p>").concat(n.description,'</p>\n                    <div class="story-footer">\n                        <span class="story-date">Posted on: ').concat(new Date(n.createdAt).toLocaleDateString(),'</span>\n                        <button class="save-story ').concat(t?"saved":"",'" aria-label="Save story">\n                            <i class="').concat(t?"fas":"far",' fa-bookmark"></i>\n                        </button>\n                    </div>\n                </div>\n            </article>\n        ')}},{key:"renderAddStoryForm",value:function(){document.getElementById("app").innerHTML='\n            <main id="main-content" class="add-story-container page-transition" tabindex="-1">\n                <h2>Add New Story</h2>\n                <form id="add-story-form" class="story-form">\n                    <div class="form-group">\n                        <label for="photo">Photo</label>\n                        <div class="photo-options">\n                            <label class="photo-option">\n                                <input type="file" \n                                       id="photo-gallery" \n                                       name="photo" \n                                       accept="image/*"\n                                       required\n                                       aria-required="true">\n                                <span class="option-button">\n                                    <i class="fas fa-images" aria-hidden="true"></i>\n                                    Choose from Gallery\n                                </span>\n                            </label>\n                            <label class="photo-option" id="open-camera">\n                                <input type="button" style="display: none;">\n                                <span class="option-button">\n                                    <i class="fas fa-camera" aria-hidden="true"></i>\n                                    Take Photo\n                                </span>\n                            </label>\n                        </div>\n                        <div id="camera-preview" style="display: none;" aria-live="polite">\n                            <video id="video" autoplay playsinline style="width: 100%; border-radius: var(--border-radius);" aria-label="Camera preview"></video>\n                            <div class="camera-controls">\n                                <button type="button" id="capture-btn" class="capture-button">\n                                    <i class="fas fa-camera" aria-hidden="true"></i>\n                                    Capture Photo\n                                </button>\n                                <button type="button" id="close-camera" class="close-camera-button">\n                                    <i class="fas fa-times" aria-hidden="true"></i>\n                                </button>\n                            </div>\n                            <canvas id="canvas" style="display: none;" aria-hidden="true"></canvas>\n                        </div>\n                        <div id="photo-preview" style="display: none;" aria-live="polite">\n                            <img id="preview-image" src="" alt="Captured photo" style="width: 100%; border-radius: var(--border-radius);">\n                            <div class="photo-status">\n                                <i class="fas fa-check-circle" aria-hidden="true"></i>\n                                <span>Photo captured successfully!</span>\n                            </div>\n                        </div>\n                        <small class="form-text">Select a photo to upload</small>\n                    </div>\n                    <div class="form-group description-container">\n                        <label for="description">Description</label>\n                        <textarea id="description" \n                                name="description" \n                                required \n                                aria-required="true"\n                                placeholder="Tell your story..."></textarea>\n                    </div>\n                    <div class="form-group">\n                        <label>Location</label>\n                        <div id="map" style="height: 300px; border-radius: var(--border-radius);" aria-label="Map for selecting location"></div>\n                        <input type="hidden" id="lat" name="lat" required aria-required="true">\n                        <input type="hidden" id="lon" name="lon" required aria-required="true">\n                        <small class="form-text">Click on the map to set location</small>\n                    </div>\n                    <button type="submit" class="submit-button">Add Story</button>\n                </form>\n            </main>\n        ',this.setupCamera()}},{key:"setupCamera",value:function(){var n=document.getElementById("video"),t=document.getElementById("canvas"),e=document.getElementById("capture-btn"),r=document.getElementById("open-camera"),o=document.getElementById("close-camera"),a=document.getElementById("camera-preview"),i=document.getElementById("photo-preview"),s=document.getElementById("preview-image"),c=document.getElementById("photo-gallery"),u=null;function l(){return(l=M(q().mark((function t(){return q().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:{ideal:1280},height:{ideal:720}}});case 3:u=t.sent,n.srcObject=u,a.style.display="block",i.style.display="none",t.next=13;break;case 9:t.prev=9,t.t0=t.catch(0),console.error("Error accessing camera:",t.t0),alert("Could not access camera. Please check permissions and try again.");case 13:case"end":return t.stop()}}),t,null,[[0,9]])})))).apply(this,arguments)}function d(){u&&(u.getTracks().forEach((function(n){return n.stop()})),u=null),a.style.display="none"}r.addEventListener("click",(function(){return l.apply(this,arguments)})),o.addEventListener("click",d),e.addEventListener("click",(function(){var e=t.getContext("2d");t.width=n.videoWidth,t.height=n.videoHeight,e.drawImage(n,0,0,t.width,t.height),t.toBlob((function(n){var t=new File([n],"photo.jpg",{type:"image/jpeg"}),e=new DataTransfer;e.items.add(t),c.files=e.files,s.src=URL.createObjectURL(n),i.style.display="block",d()}),"image/jpeg",.95)}))}},{key:"renderHome",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];document.getElementById("app").innerHTML='\n            <div class="home-container page-transition">\n                <main id="main-content" tabindex="-1">\n                    <div class="home-header">\n                        <h1>Welcome to Story App</h1>\n                        <p class="subtitle">Share your stories, connect with others</p>\n                    </div>\n                    <div class="home-content">\n                        <div class="feature-card">\n                            <div class="card-icon">\n                                <i class="fas fa-book-open" aria-hidden="true"></i>\n                            </div>\n                            <div class="card-content">\n                                <h2>Read Stories</h2>\n                                <p>Discover and read interesting stories from around the world. Join our community of storytellers and readers.</p>\n                                <a href="#/stories" class="btn-primary">\n                                    <span>Browse Stories</span>\n                                    <i class="fas fa-arrow-right" aria-hidden="true"></i>\n                                </a>\n                            </div>\n                        </div>\n                        <div class="feature-card">\n                            <div class="card-icon">\n                                <i class="fas fa-plus-circle" aria-hidden="true"></i>\n                            </div>\n                            <div class="card-content">\n                                <h2>Share Your Story</h2>\n                                <p>Create and share your own stories with the community. Let your voice be heard and inspire others.</p>\n                                <a href="#/add-story" class="btn-primary">\n                                    <span>Add Story</span>\n                                    <i class="fas fa-arrow-right" aria-hidden="true"></i>\n                                </a>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="map-container">\n                        <h2>Story Locations</h2>\n                        <div id="home-map" style="height: 400px; border-radius: var(--border-radius);" aria-label="Map showing story locations"></div>\n                    </div>\n                </main>\n            </div>\n        ',this.setupHomeMap(n)}},{key:"setupHomeMap",value:function(n){var t=this;if(document.getElementById("home-map")){this.map&&this.map.remove(),this.map=L.map("home-map").setView(b.DEFAULT_CENTER,b.DEFAULT_ZOOM);var e={};b.TILE_LAYERS.forEach((function(n){e[n.name]=L.tileLayer(n.url,{attribution:n.attribution})})),e[b.TILE_LAYERS[0].name].addTo(this.map),L.control.layers(e).addTo(this.map).getContainer().id="map-layer-control";var r=n.filter((function(n){var t=n.lat&&n.lon;return t||console.log("Story without location:",n),t}));if(r.forEach((function(n){var e=L.marker([n.lat,n.lon]).addTo(t.map),r=n.name.charAt(0).toUpperCase();e.bindPopup('\n                <div class="story-popup">\n                    <img src="'.concat(n.photoUrl,'" alt="').concat(n.description,'" class="story-popup-image">\n                    <div class="story-popup-content">\n                        <div class="story-popup-header">\n                            <div class="story-popup-avatar">\n                                ').concat(r,'\n                            </div>\n                            <div class="story-popup-info">\n                                <h3 class="story-popup-name">').concat(n.name,'</h3>\n                                <p class="story-popup-date">').concat(new Date(n.createdAt).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric"}),'</p>\n                            </div>\n                        </div>\n                        <p class="story-popup-description">').concat(n.description,'</p>\n                        <div class="story-popup-footer">\n                            <div class="story-popup-location">\n                                <i class="fas fa-map-marker-alt"></i>\n                                <span>Story Location</span>\n                            </div>\n                            <a href="#/stories" class="story-popup-view">\n                                View Story\n                            </a>\n                        </div>\n                    </div>\n                </div>\n            '))})),r.length>0){var o=L.latLngBounds(r.map((function(n){return[n.lat,n.lon]})));this.map.fitBounds(o)}else console.log("No stories with location found"),this.map.setView(b.DEFAULT_CENTER,b.DEFAULT_ZOOM);setTimeout((function(){t.map.invalidateSize()}),100)}else console.error("Map container not found")}},{key:"showError",value:function(n){var t=document.createElement("div");t.className="error-message",t.textContent=n;var e=document.querySelector(".auth-form")||document.querySelector(".story-form");if(e)e.prepend(t),setTimeout((function(){return t.remove()}),5e3);else{var r=document.getElementById("app");r&&(r.prepend(t),setTimeout((function(){return t.remove()}),5e3))}}},{key:"showSuccess",value:function(n){var t=document.createElement("div");t.className="success-message",t.textContent=n;var e=document.querySelector(".auth-form")||document.querySelector(".story-form");if(e)e.prepend(t),setTimeout((function(){return t.remove()}),5e3);else{var r=document.getElementById("app");r&&(r.prepend(t),setTimeout((function(){return t.remove()}),5e3))}}}],t&&Y(n.prototype,t),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,t,e}();function V(n){return V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},V(n)}function J(){J=function(){return t};var n,t={},e=Object.prototype,r=e.hasOwnProperty,o=Object.defineProperty||function(n,t,e){n[t]=e.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function u(n,t,e){return Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}),n[t]}try{u({},"")}catch(n){u=function(n,t,e){return n[t]=e}}function l(n,t,e,r){var a=t&&t.prototype instanceof y?t:y,i=Object.create(a.prototype),s=new A(r||[]);return o(i,"_invoke",{value:j(n,e,s)}),i}function d(n,t,e){try{return{type:"normal",arg:n.call(t,e)}}catch(n){return{type:"throw",arg:n}}}t.wrap=l;var p="suspendedStart",h="suspendedYield",f="executing",m="completed",v={};function y(){}function g(){}function b(){}var w={};u(w,i,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(F([])));k&&k!==e&&r.call(k,i)&&(w=k);var E=b.prototype=y.prototype=Object.create(w);function L(n){["next","throw","return"].forEach((function(t){u(n,t,(function(n){return this._invoke(t,n)}))}))}function S(n,t){function e(o,a,i,s){var c=d(n[o],n,a);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==V(l)&&r.call(l,"__await")?t.resolve(l.__await).then((function(n){e("next",n,i,s)}),(function(n){e("throw",n,i,s)})):t.resolve(l).then((function(n){u.value=n,i(u)}),(function(n){return e("throw",n,i,s)}))}s(c.arg)}var a;o(this,"_invoke",{value:function(n,r){function o(){return new t((function(t,o){e(n,r,t,o)}))}return a=a?a.then(o,o):o()}})}function j(t,e,r){var o=p;return function(a,i){if(o===f)throw Error("Generator is already running");if(o===m){if("throw"===a)throw i;return{value:n,done:!0}}for(r.method=a,r.arg=i;;){var s=r.delegate;if(s){var c=T(s,r);if(c){if(c===v)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=f;var u=d(t,e,r);if("normal"===u.type){if(o=r.done?m:h,u.arg===v)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=m,r.method="throw",r.arg=u.arg)}}}function T(t,e){var r=e.method,o=t.iterator[r];if(o===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=n,T(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var a=d(o,t.iterator,e.arg);if("throw"===a.type)return e.method="throw",e.arg=a.arg,e.delegate=null,v;var i=a.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,v):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,v)}function O(n){var t={tryLoc:n[0]};1 in n&&(t.catchLoc=n[1]),2 in n&&(t.finallyLoc=n[2],t.afterLoc=n[3]),this.tryEntries.push(t)}function P(n){var t=n.completion||{};t.type="normal",delete t.arg,n.completion=t}function A(n){this.tryEntries=[{tryLoc:"root"}],n.forEach(O,this),this.reset(!0)}function F(t){if(t||""===t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function e(){for(;++o<t.length;)if(r.call(t,o))return e.value=t[o],e.done=!1,e;return e.value=n,e.done=!0,e};return a.next=a}}throw new TypeError(V(t)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(n){var t="function"==typeof n&&n.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,b):(n.__proto__=b,u(n,c,"GeneratorFunction")),n.prototype=Object.create(E),n},t.awrap=function(n){return{__await:n}},L(S.prototype),u(S.prototype,s,(function(){return this})),t.AsyncIterator=S,t.async=function(n,e,r,o,a){void 0===a&&(a=Promise);var i=new S(l(n,e,r,o),a);return t.isGeneratorFunction(e)?i:i.next().then((function(n){return n.done?n.value:i.next()}))},L(E),u(E,c,"Generator"),u(E,i,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),t.keys=function(n){var t=Object(n),e=[];for(var r in t)e.push(r);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=F,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(P),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var n=this.tryEntries[0].completion;if("throw"===n.type)throw n.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function o(r,o){return s.type="throw",s.arg=t,e.next=r,o&&(e.method="next",e.arg=n),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],s=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(n,t){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===n||"continue"===n)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=n,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(i)},complete:function(n,t){if("throw"===n.type)throw n.arg;return"break"===n.type||"continue"===n.type?this.next=n.arg:"return"===n.type?(this.rval=this.arg=n.arg,this.method="return",this.next="end"):"normal"===n.type&&t&&(this.next=t),v},finish:function(n){for(var t=this.tryEntries.length-1;t>=0;--t){var e=this.tryEntries[t];if(e.finallyLoc===n)return this.complete(e.completion,e.afterLoc),P(e),v}},catch:function(n){for(var t=this.tryEntries.length-1;t>=0;--t){var e=this.tryEntries[t];if(e.tryLoc===n){var r=e.completion;if("throw"===r.type){var o=r.arg;P(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:F(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=n),v}},t}function Z(n,t,e,r,o,a,i){try{var s=n[a](i),c=s.value}catch(n){return void e(n)}s.done?t(c):Promise.resolve(c).then(r,o)}function W(n){return function(){var t=this,e=arguments;return new Promise((function(r,o){var a=n.apply(t,e);function i(n){Z(a,r,o,i,s,"next",n)}function s(n){Z(a,r,o,i,s,"throw",n)}i(void 0)}))}}function X(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,$(r.key),r)}}function $(n){var t=function(n){if("object"!=V(n)||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var e=t.call(n,"string");if("object"!=V(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(n);return"symbol"==V(t)?t:t+""}var K=function(){return n=function n(){!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.model=new F,this.view=new U,this.map=null,this.marker=null,this.setupAuthButton()},t=[{key:"setupAuthButton",value:function(){var n=this,t=document.getElementById("auth-button");if(t){var e=function(){var e=n.model.isAuthenticated(),r=t.querySelector("i"),o=t.querySelector("span");e?(r.className="fas fa-sign-out-alt",o.textContent="Sign Out",t.onclick=function(){return n.logout()}):(r.className="fas fa-sign-in-alt",o.textContent="Sign In",t.onclick=function(){window.location.hash=k,n.showLoginForm()})};this.model.onAuthStateChange=e,e()}}},{key:"logout",value:function(){this.model.logout(),window.location.hash=k}},{key:"init",value:(a=W(J().mark((function n(){return J().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:this.model.isAuthenticated()||(window.location.hash=k),this.setupRouter(),this.handleRoute();case 3:case"end":return n.stop()}}),n,this)}))),function(){return a.apply(this,arguments)})},{key:"setupRouter",value:function(){var n=this;window.addEventListener("hashchange",(function(){console.log("Hash changed:",window.location.hash),n.handleRoute()}))}},{key:"handleRoute",value:function(){var n=window.location.hash;if(console.log("Current hash:",n),console.log("Is authenticated:",this.model.isAuthenticated()),!n||"#"===n||n===w)return console.log("No hash or home route, checking auth..."),void(this.model.isAuthenticated()?(console.log("Authenticated, showing home"),this.showHome()):(console.log("Not authenticated, redirecting to login"),window.location.hash=k,this.showLoginForm()));if(!this.model.isAuthenticated()&&n!==k&&n!==E)return console.log("Not authenticated, redirecting to login"),window.location.hash=k,void this.showLoginForm();switch(n){case w:console.log("Home route"),this.showHome();break;case k:console.log("Login route"),this.showLoginForm();break;case E:console.log("Register route"),this.showRegisterForm();break;case x:this.loadStories();break;case"#/saved-stories":this.loadSavedStories();break;case"#/add-story":this.showAddStoryForm();break;default:console.log("Unknown route, redirecting to home"),window.location.hash=w}}},{key:"showLoginForm",value:function(){this.view.renderLoginForm(),this.setupLoginForm(),this.setupAuthLinks()}},{key:"showRegisterForm",value:function(){this.view.renderRegisterForm(),this.setupRegisterForm(),this.setupAuthLinks()}},{key:"setupLoginForm",value:function(){var n=this,t=document.getElementById("login-form");t&&t.addEventListener("submit",function(){var e=W(J().mark((function e(r){var o,a;return J().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),o=t.email.value,a=t.password.value,e.prev=3,e.next=6,n.model.login(o,a);case 6:e.sent?window.location.hash=w:n.view.showError("Login failed. Please check your credentials."),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(3),console.error("Login error:",e.t0),n.view.showError(e.t0.message||"An error occurred during login. Please try again.");case 14:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(n){return e.apply(this,arguments)}}())}},{key:"setupRegisterForm",value:function(){var n=this,t=document.getElementById("register-form");t&&t.addEventListener("submit",function(){var e=W(J().mark((function e(r){var o,a,i;return J().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),o=t.name.value,a=t.email.value,i=t.password.value,e.prev=4,e.next=7,n.model.register(o,a,i);case 7:e.sent?(n.view.showSuccess("Registration successful! Please login with your credentials."),window.location.hash=k):n.view.showError("Registration failed. Please try again."),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(4),console.error("Registration error:",e.t0),n.view.showError(e.t0.message||"An error occurred during registration. Please try again.");case 15:case"end":return e.stop()}}),e,null,[[4,11]])})));return function(n){return e.apply(this,arguments)}}())}},{key:"loadStories",value:(o=W(J().mark((function n(){var t;return J().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,this.model.fetchStories();case 3:(t=n.sent)&&0!==t.length?this.view.renderStories(t):this.view.showError("No stories found. Be the first to share your story!"),n.next=11;break;case 7:n.prev=7,n.t0=n.catch(0),console.error("Error loading stories:",n.t0),this.view.showError("Failed to load stories. Please try again later.");case 11:case"end":return n.stop()}}),n,this,[[0,7]])}))),function(){return o.apply(this,arguments)})},{key:"loadSavedStories",value:(r=W(J().mark((function n(){var t;return J().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,R.getAllStories();case 3:(t=n.sent)&&0!==t.length?this.view.renderStories(t):this.view.showError("No saved stories yet. Start saving your favorite stories!"),n.next=11;break;case 7:n.prev=7,n.t0=n.catch(0),console.error("Error loading saved stories:",n.t0),this.view.showError("Failed to load saved stories. Please try again later.");case 11:case"end":return n.stop()}}),n,this,[[0,7]])}))),function(){return r.apply(this,arguments)})},{key:"showAddStoryForm",value:function(){var n=this;this.view.renderAddStoryForm(),setTimeout((function(){return n.setupMap()}),0),this.setupAddStoryForm()}},{key:"setupMap",value:function(){var n=this;if(document.getElementById("map")){if(!this.map){this.map=L.map("map").setView(b.DEFAULT_CENTER,b.DEFAULT_ZOOM);var t={};b.TILE_LAYERS.forEach((function(n){t[n.name]=L.tileLayer(n.url,{attribution:n.attribution})})),t[b.TILE_LAYERS[0].name].addTo(this.map),L.control.layers(t).addTo(this.map),this.map.on("click",(function(t){n.marker&&n.map.removeLayer(n.marker),n.marker=L.marker(t.latlng).addTo(n.map),document.getElementById("lat").value=t.latlng.lat,document.getElementById("lon").value=t.latlng.lng}))}}else console.error("Map container not found")}},{key:"setupAddStoryForm",value:function(){var n=this,t=document.getElementById("add-story-form");t&&t.addEventListener("submit",function(){var e=W(J().mark((function e(r){var o,a,i,s,c;return J().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),o=new FormData,a=t.querySelector('input[name="photo"]').files[0],i=t.querySelector('textarea[name="description"]').value,s=t.querySelector('input[name="lat"]').value,c=t.querySelector('input[name="lon"]').value,o.append("photo",a),o.append("description",i),o.append("lat",s),o.append("lon",c),e.prev=10,e.next=13,n.model.addStory(o);case 13:e.sent?(n.view.showSuccess("Story added successfully!"),window.location.hash=x):n.view.showError("Failed to add story. Please try again."),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(10),console.error("Error adding story:",e.t0),n.view.showError(e.t0.message||"An error occurred while adding your story. Please try again.");case 21:case"end":return e.stop()}}),e,null,[[10,17]])})));return function(n){return e.apply(this,arguments)}}())}},{key:"showHome",value:(e=W(J().mark((function n(){var t;return J().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,this.model.fetchStories();case 3:t=n.sent,this.view.renderHome(t),n.next=11;break;case 7:n.prev=7,n.t0=n.catch(0),console.error("Error loading stories for home page:",n.t0),this.view.renderHome([]);case 11:case"end":return n.stop()}}),n,this,[[0,7]])}))),function(){return e.apply(this,arguments)})},{key:"setupAuthLinks",value:function(){var n=document.querySelectorAll(".auth-link");console.log("Setting up auth links:",n.length),n.forEach((function(n){var t=n.getAttribute("href");console.log("Found auth link with href:",t),n.addEventListener("click",(function(n){n.preventDefault(),console.log("Auth link clicked, navigating to:",t),window.location.hash=t}))}))}}],t&&X(n.prototype,t),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,t,e,r,o,a}();document.addEventListener("DOMContentLoaded",(function(){(new K).init()}))})();