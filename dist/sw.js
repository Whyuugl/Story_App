const CACHE_NAME="story-app-v1",urlsToCache=["/","/index.html","/src/styles.css","/bundle.js","/icons/icon-192x192.png","/icons/badge-72x72.png"];self.addEventListener("install",(e=>{console.log("Service Worker installing..."),e.waitUntil(caches.open(CACHE_NAME).then((e=>(console.log("Opened cache"),Promise.all(urlsToCache.map((t=>fetch(t).then((n=>{if(!n.ok)throw new Error(`Failed to fetch ${t}: ${n.status}`);return e.put(t,n)})).catch((e=>{console.error(`Failed to cache ${t}:`,e)})))))))))})),self.addEventListener("activate",(e=>{console.log("Service Worker activated"),e.waitUntil(caches.keys().then((e=>Promise.all(e.filter((e=>e!==CACHE_NAME)).map((e=>caches.delete(e)))))))})),self.addEventListener("fetch",(e=>{e.respondWith(caches.match(e.request).then((t=>t||fetch(e.request))))})),self.addEventListener("push",(e=>{console.log("Push event received:",e);let t={};try{t=e.data.json()}catch(n){t={title:"New Story Update",body:e.data.text()}}const n={body:t.body||"A new story has been added!",icon:"/icons/icon-192x192.png",badge:"/icons/badge-72x72.png",vibrate:[100,50,100],data:{dateOfArrival:Date.now(),primaryKey:1}};e.waitUntil(self.registration.showNotification(t.title||"New Story Update",n))})),self.addEventListener("notificationclick",(e=>{console.log("Notification clicked:",e),e.notification.close(),e.waitUntil(clients.matchAll({type:"window"}).then((e=>{for(const t of e)if("/"===t.url&&"focus"in t)return t.focus();if(clients.openWindow)return clients.openWindow("/")})))}));